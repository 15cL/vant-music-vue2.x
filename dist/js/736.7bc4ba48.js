"use strict";(self["webpackChunkvue_littlefivemusic"]=self["webpackChunkvue_littlefivemusic"]||[]).push([[736],{6736:function(s,t,e){e.r(t),e.d(t,{default:function(){return u}});var a=function(){var s=this,t=s._self._c;return t("BS_Scroll",{ref:"res_wrap",class:["wrapper",s.currentPlaySong.id?"has_play":"no_play"],attrs:{data:s.searchSongRes.songs,pullup:s.pullup,click:!0},on:{pullup:s.onLoad}},[t("div",{staticClass:"search_res"},[s.searchSongRes.searchQcReminder?t("div",{staticClass:"tip"},s._l(s.searchSongRes.searchQcReminder.qcReminders,(function(e,a){return t("span",{key:a,style:{color:e.highLight?"rgb(110, 110, 171)":"",textDecoration:e.highLight?"underline":""}},[s._v(s._s(e.qcReminderPart))])})),0):s._e(),t("h2",[s._v("单曲")]),t("ul",{staticClass:"ul_song"},s._l(s.searchSongRes.songs,(function(e,a){return t("li",{key:e.id,staticClass:"li_song",on:{click:function(t){return s.toPlay(e.id,e,a)}}},[s.tapFlag!==a?t("span",[s._v(s._s(a+1))]):t("span",{staticClass:"iconfont icon-bar-chart-fill",staticStyle:{color:"orange","font-size":"1.3rem"}}),t("div",{staticClass:"zj_text"},[t("h3",{class:s.tapFlag==a?"active":""},[s._v(" "+s._s(e.name)+" ")]),t("div",{staticClass:"gray csl"},[t("span",[s._v(s._s(e.ar))]),s._v(" - "+s._s(e.al.name)+" ")])]),t("span",{staticClass:"iconfont icon-yuandiancaidan"})])})),0),s.loading?t("van-loading",{attrs:{size:"1.5rem",vertical:""}},[s.finished?s._e():t("span",[s._v("加载中...")])]):s._e()],1)])},i=[],r=(e(541),e(7658),e(472)),n=e(3822),l={props:["keyword"],data(){return{offset:"",searchSongRes:"",tapFlag:null,loading:!0,finished:!1,pullup:!0}},computed:{...(0,n.Se)(["currentPlaySong"])},watch:{currentPlaySong(){this.keyword&&this.searchSong(this.keyword)}},created(){this.keyword&&this.searchSong(this.keyword)},methods:{...(0,n.nv)(["search/getSearchRes","play/getPlayUrl"]),...(0,n.OI)(["search/setSearchHistory","play/setCurrentPlaySong","play/setCurrentPlayList"]),async searchSong(s){this.offset=0;let t=JSON.parse(window.localStorage.getItem("keywords"))||[],e=t.findIndex((t=>t==s));-1==e&&(t.unshift(s),this["search/setSearchHistory"](t));let a={keywords:s,type:1,offset:this.offset},i=await this["search/getSearchRes"](a);i.data.result.songs.map((s=>{s.ar=(0,r.v)(s.ar)})),this.searchSongRes=i.data.result,this["play/setCurrentPlayList"](this.searchSongRes.songs),this.tapFlag=this.searchSongRes.songs.findIndex((s=>s.id==this.currentPlaySong.id))},async onLoad(){if(this.finished)return;if(this.pullup=!0,this.offset=this.offset+1,this.offset>=6)return void(this.pullup=!1);let s={keywords:this.keyword,type:1,offset:this.offset},t=await this["search/getSearchRes"](s);this.searchSongRes&&t.data.result.songs.map((s=>{s.ar=(0,r.v)(s.ar),this.searchSongRes.songs.push(s)})),this["play/setCurrentPlayList"](this.searchSongRes.songs),this.loading=!1},async toPlay(s,t,e){let a=await this["play/getPlayUrl"](s);if(!a)return this.$toast("当前音乐无可用资源"),this.toPlay(this.allSong[e+1].id,this.allSong[e+1],e+1);this.tapFlag=e,this.$store.commit("play/switchPlayer"),this["play/setCurrentPlaySong"](t)}}},o=l,h=e(1001),c=(0,h.Z)(o,a,i,!1,null,"63f014cd",null),u=c.exports}}]);